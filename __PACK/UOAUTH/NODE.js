UOAUTH.GENERATE_AUTHORIZATION=METHOD(function(e){"use strict";var t=require("crypto"),o=require("querystring"),r=function(e,o,r){var n=t.createHmac("sha1",e);return n.update(o),n.digest(r)};return{run:function(e,t){var n=e.url,u=e.method,i=void 0===e.paramStr?{}:o.parse(e.paramStr),a=e.consumerKey,s=e.consumerSecret,d=void 0===e.tokenSecret?"":e.tokenSecret,c=e.token,E=e.verifier,h=RANDOM_STR(42),p=INTEGER(Date.now()/1e3),T={oauth_consumer_key:a,oauth_nonce:h,oauth_signature_method:"HMAC-SHA1",oauth_timestamp:p,oauth_token:c,oauth_verifier:E,oauth_version:"1.0"},m=COMBINE([i,T]),O=Object.keys(m).sort(),v="",U="OAuth ";return EACH(O,function(e,t){void 0!==m[e]&&(v+=""===v?e+"="+encodeURIComponent(m[e]):"&"+e+"="+encodeURIComponent(m[e]))}),v=encodeURIComponent(v),EACH(T,function(e,t){void 0!==e&&("OAuth "===U?U+=t+'="'+encodeURIComponent(e)+'"':("oauth_signature_method"===t&&(U+=', oauth_signature="'+encodeURIComponent(r(s+"&"+d,u+"&"+encodeURIComponent(n)+"&"+v,"base64"))+'"'),U+=", "+t+'="'+encodeURIComponent(e)+'"'))}),U}}}),UOAUTH.GET_TOKEN=METHOD(function(e){"use strict";var t=require("url"),o=require("querystring");return{run:function(e,r){var n=e.url,u=t.parse(n);UOAUTH.REQUEST({isSecure:"https:"===u.protocol,host:u.hostname===TO_DELETE?void 0:u.hostname,port:u.port===TO_DELETE?void 0:INTEGER(u.port),method:"POST",uri:u.pathname===TO_DELETE?void 0:u.pathname.substring(1),headers:{Authorization:UOAUTH.GENERATE_AUTHORIZATION(e)}},function(e){r(o.parse(e))})}}}),UOAUTH.REQUEST=METHOD(function(){"use strict";var e=require("http"),t=require("https");return{run:function(o,r){var n,u,i,a=o.host,s=o.isSecure,d=void 0===o.port?s!==!0?80:443:o.port,c=o.method,E=o.uri,h=o.paramStr,p=o.headers;c=c.toUpperCase(),void 0!==E&&-1!==E.indexOf("?")&&(h=E.substring(E.indexOf("?")+1)+(void 0===h?"":"&"+h),E=E.substring(0,E.indexOf("?"))),CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,u=r.error),void 0===h&&(h=""),"GET"===c?i=(s!==!0?e:t).get({hostname:a,port:d,path:"/"+(void 0===E?"":E)+"?"+h,headers:p},function(e){var t;301===e.statusCode||302===e.statusCode?(GET(e.headers.location,{success:n,error:u}),e.destroy()):(t="",e.setEncoding("utf-8"),e.on("data",function(e){t+=e}),e.on("end",function(){n(t,e.headers)}))}):(i=(s!==!0?e:t).request({hostname:a,port:d,path:"/"+(void 0===E?"":E),method:c,headers:p},function(e){var t="";e.setEncoding("utf-8"),e.on("data",function(e){t+=e}),e.on("end",function(){n(t,e.headers)})}),i.write(h),i.end()),i.on("error",function(e){var t=e.toString();void 0!==u?u(t):SHOW_ERROR("[UOAUTH] REQUEST FAILED: "+t,o)})}}});