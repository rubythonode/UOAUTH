UOAUTH.GENERATE_AUTHORIZATION=METHOD(function(e){"use strict";var t=require("crypto"),o=require("querystring"),n=function(e,o,n){var r=t.createHmac("sha1",e);return r.update(o),r.digest(n)};return{run:function(e,t){var r=e.url,u=e.method,a=void 0===e.paramStr?{}:o.parse(e.paramStr),i=e.consumerKey,c=e.consumerSecret,s=void 0===e.tokenSecret?"":e.tokenSecret,E=e.token,h=e.verifier,T=RANDOM_STR(42),m=INTEGER(Date.now()/1e3),p={oauth_consumer_key:i,oauth_nonce:T,oauth_signature_method:"HMAC-SHA1",oauth_timestamp:m,oauth_token:E,oauth_verifier:h,oauth_version:"1.0"},d=COMBINE([a,p]),O=Object.keys(d).sort(),_="",A="OAuth ";return EACH(O,function(e,t){void 0!==d[e]&&(_+=""===_?e+"="+encodeURIComponent(d[e]):"&"+e+"="+encodeURIComponent(d[e]))}),_=encodeURIComponent(_),EACH(p,function(e,t){void 0!==e&&("OAuth "===A?A+=t+'="'+encodeURIComponent(e)+'"':("oauth_signature_method"===t&&(A+=', oauth_signature="'+encodeURIComponent(n(c+"&"+s,u+"&"+encodeURIComponent(r)+"&"+_,"base64"))+'"'),A+=", "+t+'="'+encodeURIComponent(e)+'"'))}),A}}}),UOAUTH.GET_TOKEN=METHOD(function(e){"use strict";var t=require("url"),o=require("querystring");return{run:function(e,n){var r=e.url,u=t.parse(r);POST({isSecure:"https:"===u.protocol,host:u.hostname===TO_DELETE?void 0:u.hostname,port:u.port===TO_DELETE?void 0:INTEGER(u.port),uri:u.pathname===TO_DELETE?void 0:u.pathname.substring(1),headers:{Authorization:UOAUTH.GENERATE_AUTHORIZATION(e)}},function(e){n(o.parse(e))})}}});